
# Descubriendo Patrones con Regresi√≥n Lineal


![](img/reg_1.png){ width="60%" fig-align="center" }

Imagina que eres due√±o de un restaurante üçù.  
Cada d√≠a recibes clientes, vendes platos y al final de la semana te preguntas:

> **¬øQu√© hace que mis ventas suban o bajen?**  
> ¬øSer√° el precio de los platos, la inversi√≥n en publicidad, o quiz√° los fines de semana festivos?

Aqu√≠ entra en acci√≥n la **regresi√≥n lineal**, una herramienta que nos ayuda a descubrir patrones escondidos en los datos.



## Una primera pista con la Regresi√≥n Simple

Empecemos simple: ¬øqu√© pasa con tus ventas y el precio del men√∫?  

Si anotas tus datos semana a semana y los pones en un gr√°fico como el de abajo, notar√°s que cuando el precio sube, las ventas tienden a bajar. La regresi√≥n lineal traza la **mejor l√≠nea recta** que explica esa relaci√≥n.

![Gr√°fico de dispersi√≥n ventas vs. precio](img/reg_2.png){ width="60%" fig-align="center" }


La ecuaci√≥n que representa la l√≠nea roja de ese gr√°fico se ve as√≠:

$$
Ventas = b_0 + b_1 \times Precio + \varepsilon
$$

- **$b_0$**: el punto de partida (ventas cuando el precio es cero, aunque no sea realista vender gratis üçï).  
- **$b_1$**: la *pendiente*; cu√°nto cambian las ventas si subes el precio en una unidad.  
- **$\varepsilon$**: el ruido que la l√≠nea no puede explicar (clima, humor del chef, partidos de f√∫tbol, etc.).  

üëâ Si el modelo encuentra que:

$$
\hat{Ventas} = 500 - 25 \times Precio
$$

significa que por cada $1 m√°s en el precio, **pierdes 25 platos vendidos en promedio**. ¬°Cuidado con pasarte de caro!

## ¬øEs realmente importante mi coeficiente? (significancia estad√≠stica)

Hasta ahora vimos que un coeficiente $b_1$ nos dice c√≥mo cambia $Y$ cuando $X$ sube una unidad.  

Pero la gran pregunta es: **¬øpodemos confiar en que ese efecto no apareci√≥ solo por azar?**

Aqu√≠ entran las **pruebas de hip√≥tesis** que estudiamos el cap√≠tulo anterior.  

### El planteamiento
- **Hip√≥tesis nula ($H_0$)**: el coeficiente es igual a 0.  
  > Es decir, que la variable no tiene efecto real en las ventas.  
- **Hip√≥tesis alternativa ($H_1$)**: el coeficiente es diferente de 0.  
  > Que s√≠ existe un impacto real.  

Para saber si tu coeficiente es realmente significativo, puedes usar el valor p (p-value). Este valor te dice la probabilidad de que el coeficiente sea cero (es decir, que no tenga efecto).

::: callout-note
## Prueba de significancia estad√≠stica
- Si el valor p es menor que 0.05, puedes decir que el coeficiente es **significativo**. Esto significa que hay evidencia suficiente para afirmar que el precio s√≠ afecta las ventas.
- Si el valor p es mayor que 0.05, no puedes rechazar la hip√≥tesis nula de que el coeficiente es cero. En otras palabras, no hay suficiente evidencia para afirmar que el precio afecta las ventas.
:::


### Ejemplo de restaurante üçù  
Supongamos que obtienes un nuevo modelo al recoger m√°s datos:

$$
\hat{Ventas} = 400 - 20 \times Precio + 60 \times Publicidad
$$

- El coeficiente de **Precio = -20** sugiere que subir $1 reduce 20 platos vendidos.  
- Pero, ¬øy si esa relaci√≥n negativa se debe solo a la casualidad en tus datos?  

### La prueba
El software (R, Excel, Stata, etc.) hace un **test t** que compara el valor del coeficiente con la variabilidad de los datos.  
De ah√≠ sale un n√∫mero m√°gico: el **p-valor**.  

- Si el **p-valor < 0.05**, rechazamos la hip√≥tesis nula.  
  > Concluimos que el efecto es significativo: el precio *s√≠ afecta* las ventas.  
- Si el **p-valor ‚â• 0.05**, no tenemos suficiente evidencia.  
  > No podemos asegurar que el precio influya: podr√≠a ser puro ruido.  

### La moraleja
Un coeficiente puede verse grande o peque√±o, positivo o negativo, pero lo crucial es saber si es **estad√≠sticamente diferente de cero**.  
Solo as√≠ podemos decir con confianza que esa variable explica parte de la historia de nuestros datos.  

üëâ En negocios, esto significa que antes de tomar decisiones (subir precios, invertir en publicidad, lanzar una promo) debemos asegurarnos de que los efectos que vemos no sean simplemente coincidencias.


## Midiendo qu√© tan bien funciona mi regresi√≥n

No basta con tener la l√≠nea (regresi√≥n), tambi√©n queremos saber **qu√© tan buena es**.  

Para eso usamos el famoso **$R^2$**, tambi√©n llamado coeficiente de determinaci√≥n:  

- Si $R^2 = 0.8$, entonces el 80% de las variaciones en ventas se explican solo con el precio.  
- El 20% restante‚Ä¶ bueno, puede ser el clima, la competencia, o ese influencer foodie que lleg√≥ sin avisar üì∏.  

Si $R^2 = 0$, tu modelo no explica nada: ser√≠a como decir que el precio no tiene relaci√≥n alguna con las ventas, y que lo √∫nico que podr√≠as hacer es mirar el promedio de todas las semanas.

Si $R^2 = 1$, tu modelo explica todo: las ventas estar√≠an perfectamente determinadas por el precio, sin misterios, sin azar, sin sorpresas (lo cual rara vez pasa en la vida real).

::: callout-tip
Piensa en $R^2$ como un term√≥metro de confianza: te dice qu√© tan buena es tu l√≠nea de regresi√≥n para capturar la historia detr√°s de tus datos. No es perfecto, pero s√≠ es una br√∫jula que te orienta sobre cu√°nto puedes fiarte de tu modelo para explicar lo que ves.
:::

## Sumando m√°s ingredientes: la Regresi√≥n M√∫ltiple

En la vida real, tus ventas no dependen solo del precio.  
En tu restaurante tambi√©n influyen otros ‚Äúingredientes‚Äù del negocio:  

- el **precio** del men√∫,  
- el **dinero invertido en publicidad**,  
- y si fue o no una **semana festiva**.  

La regresi√≥n m√∫ltiple nos permite poner todos esos factores en la misma receta estad√≠stica.Supongamos que tus datos arrojan:

$$
\hat{Ventas} = 400 - 20 \times Precio + 60 \times Publicidad + 15 \times Festivo
$$


Interpretaci√≥n:  
- Cada $1 m√°s en el precio reduce en promedio 20 platos vendidos.  
- Cada $100 en publicidad aumentan las ventas en 60 platos.  
- Si es semana festiva, se venden 15 platos extra aunque no cambie nada m√°s.  


::: callout-tip
Plantilla de interpretaci√≥n (ceteris paribus): significa que por cada unidad que aumente **variable**, la **variable dependiente** cambia en promedio **coeficiente** unidades, manteniendo constantes las dem√°s variables. 

Ejemplo: por cada $1 que aumenta el precio, las ventas semanales disminuyen en promedio 20 platos, manteniendo la publicidad y la condici√≥n de semana festiva constantes.
:::

En otras palabras, la regresi√≥n m√∫ltiple te permite **separar los efectos**:  
sabes qu√© parte de las ventas se debe al precio, qu√© parte a la publicidad y qu√© parte al calendario.  


### Significancia en la regresi√≥n m√∫ltiple

En regresi√≥n m√∫ltiple evaluamos la significancia de cada coeficiente de la misma manera que en la regresi√≥n simple: mediante un estad√≠stico t y su p-valor. Cada coeficiente se interpreta **ceteris paribus** (manteniendo las dem√°s variables constantes), por eso es importante no mezclar la interpretaci√≥n de los efectos.

Ejemplo (resumen):

- $\hat{Ventas} = 400 - 20\times Precio + 60\times Publicidad + 15\times Festivo$
- p-valores (ej.): Precio $p<0.01$ (significativo), Publicidad $p=0.18$ (no significativo), Festivo $p=0.03$ (significativo)

Aunque el coeficiente de publicidad sea 60, su p-valor elevado ($p=0.18$) indica que no hay suficiente evidencia para afirmar que la publicidad tiene un efecto sobre las ventas una vez controlamos por precio y festivo (ceteris paribus). Esto implica que aunque el coeficiente sea 60, en t√©rminos estad√≠sticos es 0.

## Conclusi√≥n

La regresi√≥n lineal, ya sea simple o m√∫ltiple, funciona como una lupa üîç:  
te ayuda a **distinguir qu√© factores realmente impulsan tus resultados** y cu√°les son solo ruido.  

En el restaurante esto significa tomar decisiones con m√°s confianza:  
¬øbajo precios?, ¬øaumento el presupuesto en publicidad?, ¬øaprovecho mejor los festivos?  

üëâ La magia est√° en que no tienes que adivinar. Los datos te cuentan la historia, y la regresi√≥n es el traductor.


# Extensiones del modelo de regresi√≥n lineal

Hasta ahora, hemos usado modelos de regresi√≥n lineal ‚Äúsimples‚Äù para predecir ventas en tu restaurante seg√∫n precio, publicidad o si era semana festiva. Pero el mundo real es m√°s complejo: las variables **pueden interactuar** entre s√≠ y la relaci√≥n con las ventas **no siempre es lineal**.  

Veamos c√≥mo ampliar la receta de la regresi√≥n lineal para capturar estos matices.  

---

## 6.1 Cuando los ingredientes se combinan: Interacciones

Imagina que lanzas un nuevo plato y quieres saber c√≥mo influye el **precio** en las ventas. Pero tal vez el impacto del precio depende de otra variable, por ejemplo, si hiciste o no **publicidad**.  

- Si no hay publicidad, un descuento en el precio podr√≠a no atraer a muchos clientes.  
- Si s√≠ hay publicidad, ese mismo descuento puede disparar las ventas.  

Esto se llama **interacci√≥n**: el efecto de una variable depende del valor de otra.  

\[
Ventas = b_0 + b_1 \times Precio + b_2 \times Publicidad + b_3 \times (Precio \times Publicidad) + \varepsilon
\]

El t√©rmino $b_3$ mide cu√°nto cambia el efecto del precio cuando hay publicidad.  

::: callout-tip
**Intuici√≥n:** no todos los ingredientes de tu receta funcionan igual por separado. A veces lo que importa es la mezcla.  
:::

---

## 6.2 Relaciones no siempre lineales

No siempre el efecto de una variable es recto como una l√≠nea. Por ejemplo:  

- Si el precio es muy bajo, las ventas suben (¬°oferta irresistible!).  
- Si subes demasiado el precio, las ventas bajan (¬°nadie quiere pagar tanto!).  

Esto dibuja una **curva** en vez de una l√≠nea.  

Para capturar ese patr√≥n podemos agregar un **t√©rmino cuadr√°tico** al modelo:  

\[
Ventas = b_0 + b_1 \times Precio + b_2 \times Precio^2 + \varepsilon
\]

- $b_1$ mide el efecto lineal del precio.  
- $b_2$ permite que la curva se doble hacia arriba o hacia abajo.  

::: callout-tip
**Intuici√≥n:** como en la cocina, no siempre m√°s de un ingrediente mejora el plato. Hay un punto √≥ptimo de sal o picante: demasiado poco o demasiado mucho arruina la receta.  
:::

```{r}
#| label: grafico-cuadratico
#| fig-cap: "Relaci√≥n cuadr√°tica entre precio y ventas (ejemplo simulado)"
#| echo: false

set.seed(123)
precio <- seq(5, 30, 1)
ventas <- 200 - 10*precio + 0.3*precio^2 + rnorm(length(precio), 0, 15)
plot(precio, ventas, pch=19, col="darkred",
     main="Ejemplo relaci√≥n cuadr√°tica",
     xlab="Precio", ylab="Ventas")
